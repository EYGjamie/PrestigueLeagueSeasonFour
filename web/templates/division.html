{% extends "base.html" %}

{% block title %}Division {{ division }} - Prestige League{% endblock %}

{% block content %}
<nav>
    <a href="/">‚Üê Zur√ºck / Back</a>
</nav>
{% if division == 1 %}
<div style="text-align: center; margin: 20px 0;">
    <a href="https://liquipedia.net/rocketleague/Astellia_Esports/Prestige_League/Season_4" 
       target="_blank" 
       rel="noopener noreferrer"
       style="display: inline-flex; align-items: center; gap: 10px; padding: 12px 24px; background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%); color: white; text-decoration: none; border-radius: 8px; font-weight: 600; box-shadow: 0 4px 6px rgba(59, 130, 246, 0.3); transition: all 0.3s ease;">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
            <polyline points="15 3 21 3 21 9"></polyline>
            <line x1="10" y1="14" x2="21" y2="3"></line>
        </svg>
        <span>Liquipedia - Division 1 Season 4</span>
    </a>
</div>
{% endif %}

<h2 style="color: #60a5fa; margin-bottom: 20px; text-shadow: 0 0 10px rgba(59, 130, 246, 0.3);">Division {{ division }} - Tabelle / Standings</h2>

<!-- Legende -->
<div class="rank-legend">
    {% if division == 1 %}
        <div class="legend-item"><div class="legend-box playoff"></div>Playoffs (1-6)</div>
        <div class="legend-item"><div class="legend-box relegation"></div>Relegation (9-10)</div>
    {% elif division == 2 %}
        <div class="legend-item"><div class="legend-box relegation"></div>Relegation (1-4)</div>
        <div class="legend-item"><div class="legend-box demotion"></div>Abstieg (9-10)</div>
    {% elif division == 3 %}
        <div class="legend-item"><div class="legend-box promotion"></div>Aufstieg (1-2)</div>
        <div class="legend-item"><div class="legend-box demotion"></div>Abstieg (9-10)</div>
    {% elif division == 4 %}
        <div class="legend-item"><div class="legend-box promotion"></div>Aufstieg (1-2)</div>
        <div class="legend-item"><div class="legend-box demotion"></div>Abstieg (8-9)</div>
    {% elif division == 5 %}
        <div class="legend-item"><div class="legend-box promotion"></div>Aufstieg (1-2)</div>
    {% endif %}
</div>

<table>
    <thead>
        <tr>
            <th>Pos</th>
            <th>Team</th>
            <th>Spiele / Played</th>
            <th>Siege / Wins</th>
            <th>Niederlagen / Losses</th>
            <th>Games Won</th>
            <th>Games Lost</th>
            <th>Games +/-</th>
        </tr>
    </thead>
    <tbody>
        {% for team in standings %}
        {% set position = loop.index %}
        {% set total_teams = standings|length %}
        {% set row_class = "" %}
        
        {# Division 1: Playoffs 1-6, Relegation 9-10 #}
        {% if division == 1 %}
            {% if position <= 6 %}
                {% set row_class = "rank-playoff" %}
            {% elif position >= 9 and position <= 10 %}
                {% set row_class = "rank-relegation" %}
            {% endif %}
        
        {# Division 2: Relegation 1-4, Abstieg 9-10 #}
        {% elif division == 2 %}
            {% if position <= 4 %}
                {% set row_class = "rank-relegation" %}
            {% elif position >= 9 and position <= 10 %}
                {% set row_class = "rank-demotion" %}
            {% endif %}
        
        {# Division 3: Aufstieg 1-2, Abstieg 9-10 #}
        {% elif division == 3 %}
            {% if position <= 2 %}
                {% set row_class = "rank-promotion" %}
            {% elif position >= 9 and position <= 10 %}
                {% set row_class = "rank-demotion" %}
            {% endif %}
        
        {# Division 4: Aufstieg 1-2, Abstieg 8-9 (nur 9 Teams) #}
        {% elif division == 4 %}
            {% if position <= 2 %}
                {% set row_class = "rank-promotion" %}
            {% elif position >= 8 and position <= 9 %}
                {% set row_class = "rank-demotion" %}
            {% endif %}
        
        {# Division 5: Aufstieg 1-2, kein Abstieg #}
        {% elif division == 5 %}
            {% if position <= 2 %}
                {% set row_class = "rank-promotion" %}
            {% endif %}
        {% endif %}
        
        <tr class="{{ row_class }}">
            <td class="position">{{ position }}</td>
            <td><strong{% if team.is_disqualified %} style="text-decoration: line-through; opacity: 0.6;"{% endif %}>{% if team.is_disqualified %} üö´{% endif %}{{ team.name }}{% if team.is_disqualified %} üö´{% endif %}</strong></td>
            <td style="text-align: center;">{{ team.played }}</td>
            <td style="text-align: center;">{{ team.wins }}</td>
            <td style="text-align: center;">{{ team.losses }}</td>
            <td style="text-align: center;">{{ team.games_won }}</td>
            <td style="text-align: center;">{{ team.games_lost }}</td>
            <td style="text-align: center;"><strong>{{ team.games_won - team.games_lost }}</strong></td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<h2 style="color: #60a5fa; margin: 40px 0 20px 0; text-shadow: 0 0 10px rgba(59, 130, 246, 0.3);">Spielplan / Matches</h2>

{% for matchday, matches in matchdays %}
<div class="matchday-section">
    <h3 class="matchday-title">Spieltag / Week {{ matchday }}</h3>
    
    {% for match in matches %}
    <div class="match-card {% if match.completed %}completed{% else %}pending{% endif %}">
        <div class="match-teams">
            <strong>{{ match.home_team }}</strong> vs <strong>{{ match.away_team }}</strong>
        </div>
        
        {% if match.completed %}
        <div class="match-score">
            {{ match.score_home }} : {{ match.score_away }}
        </div>
        {% else %}
        <div class="match-status">
            <span class="badge badge-pending">Ausstehend / Pending</span>
        </div>
        {% endif %}
    </div>
    {% endfor %}
</div>
{% endfor %}

{% endblock %}
